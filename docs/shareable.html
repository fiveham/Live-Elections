<html>
  <head>
    <title>Testing sharing buttons</title>
    
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc-rwb-check.png">
    
    <meta charset="utf-8">
    
    <meta property="og:image" 
          content="http://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc-reg-map-screenshot-square.png" />
    <meta property="og:image:url" 
          content="http://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc-reg-map-screenshot-square.png" />
    <meta property="og:image:secure_url" 
          content="https://raw.githubusercontent.com/fiveham/Elections/master/docs/images/nc-reg-map-screenshot-square.png" />
    <meta property="og:image:alt" 
          content="A satelite image of the eastern coast of North America from Maryland to Florida overlaid by a semitransparent gray 
          polygon covering North Carolina. Sites in North Carolina required by the National Voting Rights Act (1993) to provide voter 
          registration forms are marked by icons indicating the type of site." />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1660" />
    <meta property="og:image:height" content="1660" />
    
    <meta property="og:url" content="https://fiveham.github.io/Live-Elections/shareable.html" />
    <meta property="og:type" content="website" />
    <meta property="og:determiner" content="" />
    <meta property="og:title" 
          content="Experimenting with social media sharing-buttons" />
    <meta property="og:description" 
          content="This is just a page with a few social media sharing-buttons created to verify that the URLs for those link-buttons 
          work to share the page." />
    
    <style>
      a[id^="share-"] {
        display: inline-block;
        height: 40px;
        width: 40px;
        margin: 5px;
        background-repeat: no-repeat;
        background-size: contain;
        border-radius: 2px;
        z-index: 0;
      }
      
      #sharing-is-caring {
        padding: 5px;
        background-color: green;
      }
      
      a#share-linkedin:after {
        z-index: -1;
        position: absolute;
        display: block;
        height: 80%;
        width: 80%;
        top: 20%;
        left: 20%;
        border: none;
        padding: none;
        margin: none;
        background-color: white;
      }
    </style>
  </head>
  <body>
    <div id="sharing-is-caring">
      <a target="_blank" id="share-facebook"  title="Share this map on Facebook" 
         style="background-image: url('/Elections/images/social/Facebook/600px-Facebook_logo_square.png');"></a>
      <a target="_blank" id="share-twitter"   title="Share this map on Twitter" 
         style="background-image: url('/Elections/images/social/Twitter/Twitter_Logo_WhiteOnBlue.png');"></a>
      <a target="_blank" id="share-reddit"    title="Share this map on Reddit" 
         style="background-image: url('/Elections/images/social/Reddit/Artboard 1_48.png');"></a>
      <a target="_blank" id="share-tumblr"    title="Share this map on Tumblr" 
         style="background-image: url('/Elections/images/social/Tumblr/Tumblr_Logos_2018.03.06_t Icon White.png'); 
           background-size: 35.5% 62.5%; background-position: center center;"></a>
      <a target="_blank" id="share-pinterest" title="Share this map on Pinterest" 
         style="background-image: url('/Elections/images/social/Pinterest/icon_64x64.png');"></a>
      <a target="_blank" id="share-linkedin"  title="Share this map on LinkedIn" 
         style="background-image: url('/Elections/images/social/LinkedIn/In-Blue-72.png'), 
                                  url('/Elections/images/social/LinkedIn/linkedin-uncornerer.png');"></a>
    </div>
    <script>
    
      function get_meta(property){
        var metas = document.getElementsByTagName('meta');
        for(var i = 0; i<metas.length; i++){
          if(metas[i].getAttribute('property') === property){
            return metas[i].getAttribute("content");
          }
        }
        console.log("No meta found with property "+property);
      }
      
      function for_url(text){
        var result = encodeURIComponent(text);
        var replacements = [
          ['%20', '+'],
          ['%2F', '/']
        ];
        for(var i = 0; i<replacements.length; i++){
          var r = replacements[i];
          result = result.replace(new RegExp(r[0], 'g'), r[1]);
        }
        return result;
      }
      
      function as_url(base_url, params){
        var result = base_url;
        for(var i = 0; i<params.length; i++){
          var glue = i > 0 ? '&' : '?';
          var pair = params[i];
          result += glue + pair[0] + '=' + for_url(pair[1]);
        }
        return result;
      }
      
      share_buttons = [
        {name:'facebook',  bgc: 'rgb(59,87,157)',  get_href:function(url){
            var params = [['u', url]];
            return as_url('https://www.facebook.com/sharer/sharer.php', params);
            //return 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(url);
          }},
        {name:'twitter',   bgc: 'rgb(29,161,242)', get_href:function(url){
            var params = [
              ['text', "Testing sharing body text and whatnot"], 
              ['url', url]
            ];
            return as_url('https://twitter.com/intent/tweet/', params);
            //return 'https://twitter.com/intent/tweet/?text=' + encodeURIComponent(body) + '&url=' + encodeURIComponent(url);
          }},
        {name:'reddit',    bgc: 'rgb(255,69,0)',   get_href:function(url){
            var params = [
              ['title', 'Testing sharing title text, doo-dah, doo-dah'], 
              ['url', url]
            ];
            return as_url('https://www.reddit.com/submit', params);
            //return 'https://www.reddit.com/submit?title=' + encodeURIComponent(title) + '&url=' + encodeURIComponent(url);
          }},
        {name:'tumblr',    bgc: 'rgb(0,25,53)',    get_href:function(url){
            /*return https://www.tumblr.com/widgets/share/tool
            {canonicalUrl: THE OPEN-GRAPH CANONICAL URL OF THE PAGE, 
            url: THE ACTUAL URL OF THE PAGE, 
            posttype: link, 
            tags: MAP,VOTE,REGISTER, 
            title: TITLE OF THE LINK POST, 
            content: FOR A LINK POST, THE LINK'S TARGET URL,
            caption:  A DESCRIPTION OF THE LINK, 
            show-via: ATTRIBUTION, LIKE "VIA THINGY MCPLACEYFACE"}*/
            
            /*var og_canonical_url = get_meta('og:url');
            var tags = "testing,experiment";
            var title = 'This is the post title. Expeeeeeerimeeeeent.'; //Overridden by og:title, followed by og:description
            var content = url;
            var caption = "closed captions provided by: ...uh, I don't know."; //Your own personal reblogging remarks.
            var show_via = 'Sorry_not_via_anything'; //Not showing up*/
          
            var params = [
              ['canonicalUrl', get_meta('og:url')],
              ['url',          url],
              ['posttype',     'link'],
              ['tags',         'testing,experiment'],
              ['title',        'This is the post title. Expeeeeeerimeeeeent.'],      //og:title overrides, followed by og:description
              ['content',      url],                                                 //content is url for link posts
              ['caption',      "closed captions provided by: ...uh, I don't know."], //Your own personal reblogging remarks.
              ['show-via',     'Sorry_not_via_anything']                             //Not showing up
            ];
            return as_url('https://www.tumblr.com/widgets/share/tool', params);
            /*return 'https://www.tumblr.com/widgets/share/tool' +
              '?canonicalUrl=' + encodeURIComponent(og_canonical_url) +
              '&url='          + encodeURIComponent(url)     + 
              '&posttype='     + 'link' + 
              '&tags='         + encodeURIComponent(tags)    + 
              '&title='        + encodeURIComponent(title)   + 
              '&content='      + encodeURIComponent(content) + 
              '&caption='      + encodeURIComponent(caption) + 
              '&show-via='     + encodeURIComponent(show_via);*/
          }},
        {name:'pinterest', bgc: 'rgb(206,40,44)',   get_href:function(url){
            var params = [
              ['url',   url],
              ['media', get_meta('og:image:secure_url')]];
            return as_url('https://pinterest.com/pin/create/button/', params);
            /*return 'https://pinterest.com/pin/create/button/' +
              '?url='  + encodeURIComponent(url) +
              '&media=' + encodeURIComponent(get_meta('og:image:secure_url'));*/
          }},
        {name:'linkedin', bgc: 'rgb(10,102,194)',   get_href:function(url){
            var params = [
              ['mini',    'true'],
              ['url',     url],
              ['title',   get_meta('og:title')],
              ['summary', get_meta('og:description')],
              ['source',  'fiveham.github.io']
            ];
            return as_url('https://www.linkedin.com/shareArticle', params);
            /*return 'https://www.linkedin.com/shareArticle' + 
              '?mini=true' + 
              '&url='     + encodeURIComponent(url) + 
              '&title='   + encodeURIComponent(get_meta('og:title')) +
              '&summary=' + encodeURIComponent(get_meta('og:description')) + 
              '&source=fiveham.github.io';/**/
          }}
        ];
      
      share_buttons.forEach(function(e){
        var a = document.getElementById('share-'+e.name);
        a.href = e.get_href(document.location.href);
        a.style.backgroundColor = e.bgc;
      });
    </script>
  </body>
</html>
